<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
   "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap>
	<!-- 5.2.3.1 空间分析呈现（天）BSC -->
	<statement id="load_ftbStatWeekBscGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekBscGprsSpaceUsers
		( intBscId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP  ,nmLocalUsers)
		    $option$
		]]>
	</statement>
	<!-- SGSN -->
	<statement id="load_ftbStatWeekSgsnGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekSgsnGprsSpaceUsers
		( intSgsnId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP  ,nmLocalUsers)
		    $option$
		]]>
	</statement>

	<!-- 街道办 -->
	<statement id="load_ftbStatWeekStreetGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekStreetGprsSpaceUsers
		( intStreetId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP  ,nmLocalUsers)
		    $option$
		]]>
	</statement>
	<!-- 营销片区 -->
	<statement id="load_ftbStatWeekSaleAreaGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekSaleAreaGprsSpaceUsers
		( intSaleAreaId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP  ,nmLocalUsers)
		    $option$
		]]>
	</statement>
	<!-- 分公司 -->
	<statement id="load_ftbStatWeekCompanyGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekCompanyGprsSpaceUsers
		( intBranchId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP  ,nmLocalUsers)
		    $option$
		]]>
	</statement>

	<!-- 5.2.3.2 空间分析呈现_业务维（天） BSC -->
	<statement id="load_ftbStatWeekBscBussTypeUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekBscBussTypeUsers
		( intBscId,nmBussinessId,nmBussinessTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>

	<!-- SGSN -->
	<statement id="load_ftbStatWeekSgsnBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekSgsnBussTypeUsers
		( intSgsnId,nmBussinessId,nmBussinessTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- 街道办 -->
	<statement id="load_ftbStatWeekStreetBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekStreetBussTypeUsers
		( intStreetId,nmBussinessId,nmBussinessTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- 营销片区 -->
	<statement id="load_ftbStatWeekSaleAreaBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekSaleAreaBussTypeUsers
		( intSaleAreaId,nmBussinessId,nmBussinessTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- 分公司 -->
	<statement id="load_ftbStatWeekCompanyBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekCompanyBussTypeUsers
		( intBranchId,nmBussinessId,nmBussinessTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- 5.2.4 全网数据业务分析之业务 -->
	<!-- nmUsersRate float(4), nmFlushRate float(4), nmVisitCounts int, -->
	<statement id="load_ftbStatWeekGprsBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekGprsBussTypeUsers
		( nmBussinessTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		  $option$
		]]>
	</statement>
	<!-- 5.2.5 全网数据业务分析之APN ftbGnSessionData -->
	<statement id="load_ftbStatWeekApnUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnUsers
		( intApnId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<statement id="load_ftbStatWeekApnTypeUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnTypeUsers
		( intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement><!-- 5.2.6 全网数据业务分析之协议 -->
	<statement id="load_ftbStatWeekTcpProtocolUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekTcpProtocolUsers
		( intProtocolTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<statement id="load_ftbStatWeekWapProtocolUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekWapProtocolUsers
		( intWapId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement><!-- 5.2.7 全网数据业务分析之用户归属 ftbGnSignalData -->
	<statement id="load_ftbStatWeekUserBelongUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekUserBelongUsers
		( intUserBelongId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>

	<!-- 5.2.9 集团业务行为分析之空间 BSC -->
	<statement id="load_ftbStatWeekApnBscUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnBscUsers
		( intBscId,intApnId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- SGSN -->
	<statement id="load_ftbStatWeekApnSgsnUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnSgsnUsers
		( intSgsnId,intApnId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>

	<!-- 街道办 -->
	<statement id="load_ftbStatWeekApnStreetUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnStreetUsers
		( intStreetId,intApnId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- 营销片区 -->
	<statement id="load_ftbStatWeekApnSaleAreaUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnSaleAreaUsers
		( intSaleAreaId,intApnId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- 分公司 -->
	<statement id="load_ftbStatWeekApnCompanyUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnCompanyUsers
		( intBranchId,intApnId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement><!-- 5.2.10 集团业务行为分析之用户归属 ftbGnSessionData -->
	<statement id="load_ftbStatWeekApnUserBelongUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnUserBelongUsers
		( intUserBelongId,intApnTypeId,intApnId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,
		  intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>

	<statement id="load_ftbStatWeekGprsBussUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekGprsBussUsers
		( nmBussinessId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>

	<!-- 5.2.2.1 全网数据业务流量分布呈现（周） -->
	<statement id="exec_ftbStatWeekGprsTotalFlush" resultClass="java.lang.String">
		<![CDATA[
		insert into ftbStatWeekGprsTotalFlush
		( intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,nmLocalUsers)
		 select intYear,intWeek,count(distinct(nmImsi)),getdate(),count(distinct(case when intUserBelongId=1 then nmimsi else 0 end)) 
		from ftbStatApnUserHourUsers_week 
		where intYear =	datepart(yy,#dtLoadedTime#) 
		  and intWeek = datepart(wk,#dtLoadedTime#)
		  group by intYear,intWeek
		]]>
	</statement>

	<statement id="update_ftbStatWeekGprsTotalFlush" resultClass="java.lang.String">
		<![CDATA[
		  update ftbStatWeekGprsTotalFlush set 
		  nmAppUpFlush = (select sum(h.nmAppUpFlush)  from ftbStatDayGprsTotalFlush h
		  where ftbStatWeekGprsTotalFlush.intYear = h.intYear
		    and ftbStatWeekGprsTotalFlush.intWeek = h.intWeek ),
		  nmAppDownFlush = (select sum(h.nmAppDownFlush)  from ftbStatDayGprsTotalFlush h
		  where ftbStatWeekGprsTotalFlush.intYear = h.intYear
		   and ftbStatWeekGprsTotalFlush.intWeek = h.intWeek  ),
		  nmFlush =(select sum(h.nmFlush) from ftbStatDayGprsTotalFlush h
		  where ftbStatWeekGprsTotalFlush.intYear = h.intYear
		    and ftbStatWeekGprsTotalFlush.intWeek = h.intWeek   ),
		  nmLocalFlush =(select sum(h.nmLocalFlush) from ftbStatDayGprsTotalFlush h
		  where ftbStatWeekGprsTotalFlush.intYear = h.intYear
		    and ftbStatWeekGprsTotalFlush.intWeek = h.intWeek  )
		   where ftbStatWeekGprsTotalFlush.intYear = datepart(yy,#dtLoadedTime#) 
		    and ftbStatWeekGprsTotalFlush.intWeek =  datepart(wk,#dtLoadedTime#) ;
		]]>
	</statement>
	
	<!-- 5.2.2.1 全网数据业务流量分布呈现（周）2012年1月4日11:07:55 分佈式 -->
	<statement id="delete_ftbStatWeekGprsTotalFlush"
		parameterClass="com.etone.mantoeye.analyse.domain.AnalyseParam"
		resultClass="java.lang.String">
		<![CDATA[
		 delete from ftbStatWeekGprsTotalFlush 
		       where intYear =	datepart(yy,#dtLoadedTime#) 
		         and intWeek =  datepart(wk,#dtLoadedTime#)
		         and vcLocalIP is null
		]]>
	</statement>

	<!-- 5.2.2.1 全网数据业务流量分布呈现（周）2011年12月28日11:06:42 分佈式 -->
	<statement id="load_ftbStatWeekGprsTotalFlush" resultClass="java.lang.String">
		<![CDATA[
		 LOAD TABLE ftbStatWeekGprsTotalFlush ( intYear,intWeek,nmUsers,
		                                       dtStatTime,intRaitype,vcLocalIP )
		   $option$
		]]>
	</statement>

	<!-- APN按区域分布(新增) hyjun 20100222 ftbGnSessionData -->
	<statement id="load_ftbStatWeekBscApnTypeUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnBscTypeUsers
		( intBscId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- SGSN -->
	<statement id="load_ftbStatWeekSgsnApnTypeUsers" resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnSgsnTypeUsers
		( intSgsnId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>

	<!-- 街道办 -->
	<statement id="load_ftbStatWeekStreetApnTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnStreetTypeUsers
		( intStreetId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- 营销片区 -->
	<statement id="load_ftbStatWeekSaleAreaApnTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnSaleAreaTypeUsers
		( intSaleAreaId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement>
	<!-- 分公司 -->
	<statement id="load_ftbStatWeekCompanyApnTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekApnCompanyTypeUsers
		( intBranchId,intApnTypeId,
		  intYear ,
		  intWeek,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement><!-- wuzhenzhen add 20110824 自定義小區集分析_常驻人口统计表（周） GROUPAREA ftbStatWeekGroupAreaGprsResidentUsers -->
	<statement id="load_ftbStatWeekGroupAreaGprsResidentUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekGroupAreaGprsResidentUsers
		( nmAreaId,
		  intYear ,
		  intWeek ,
		  nmUsers,
		  dtStatTime,intRaitype,vcLocalIP)
		    $option$
		]]>
	</statement><!-- Wu Zhenzhen 终端的区域分布_全網 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekTerminalTypeGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekTerminalTypeGprsSpaceUsers (
		           nmTerminalId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP )
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_全網_業務 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekTerminalTypeBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekTerminalTypeBussTypeUsers (
		           nmTerminalId,
		           nmBussinessId,nmBussinessTypeId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP)
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_BSC add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekBscTerminalTypeGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekBscTerminalTypeGprsSpaceUsers (
		           nmTerminalId,intBscId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP )
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_BSC_業務 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekBscTerminalTypeBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekBscTerminalTypeBussTypeUsers (
		           nmTerminalId,intBscId,
		           nmBussinessId,nmBussinessTypeId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP)
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_SGSN add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekSgsnTerminalTypeGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekSgsnTerminalTypeGprsSpaceUsers (
		           nmTerminalId,intSgsnId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP )
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_SGSN_業務 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekSgsnTerminalTypeBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekSgsnTerminalTypeBussTypeUsers (
		           nmTerminalId,intSgsnId,
		           nmBussinessId,nmBussinessTypeId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP)
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_分公司 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekBranchTerminalTypeGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekBranchTerminalTypeGprsSpaceUsers (
		           nmTerminalId,intBranchId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP )
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_分公司 _業務 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekBranchTerminalTypeBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekBranchTerminalTypeBussTypeUsers (
		           nmTerminalId,intBranchId,
		           nmBussinessId,nmBussinessTypeId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP)
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_營銷片區 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekSaleAreaTerminalTypeGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekSaleAreaTerminalTypeGprsSpaceUsers (
		           nmTerminalId,intSaleAreaId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP )
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_營銷片區_業務 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekSaleAreaTerminalTypeBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekSaleAreaTerminalTypeBussTypeUsers (
		           nmTerminalId,intSaleAreaId,
		           nmBussinessId,nmBussinessTypeId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP)
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_街道 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekStreetTerminalTypeGprsSpaceUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekStreetTerminalTypeGprsSpaceUsers (
		           nmTerminalId,intStreetId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP )
		  $option$
		]]>
	</statement>

	<!-- Wu Zhenzhen 终端的区域分布_街道_業務 add by 2011年10月24日21:20:09 -->
	<statement id="load_ftbStatWeekStreeterminalTypeBussTypeUsers"
		resultClass="java.lang.String">
		<![CDATA[
		LOAD TABLE ftbStatWeekStreeterminalTypeBussTypeUsers (
		           nmTerminalId,intStreetId,
		           nmBussinessId,nmBussinessTypeId,
		           intYear,intWeek,nmUsers,
		           dtStatTime,intRaitype,vcLocalIP)
		  $option$
		]]>
	</statement>
</sqlMap>